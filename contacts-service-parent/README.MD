# Sample Contacts Microservice

In the `/contacts-service-parent` folder, there there is a parent Maven Project, along with 4 childs:

* [contacts-service-parent](/)
  * [contacts-api](contacts-api)
    Defines the DTOs (Data Transfer Objects) used to communicate with the Contacts Service.
  * [contacts-client](contacts-client)
    Defines a Feign client to easily communicate with the Contacts Service for Java Developers.
  * [contacts-client-spring-boot-starter](contacts-client-spring-boot-starter)
    Defines a ready-to-use Feign client for Java Developers using Spring Boot.
  * [contacts-service](contacts-service)
    The actual microservice.


## JUnit vs Core AssertJ vs Generated AssertJ 

See all these points implemented in 
* contacts-service [test mapper folder](contacts-service/src/test/java/com/github/erikrz/contacts/service/mapper).

### JUnit

```java
class ContactMapperWithJUnitTest {

  private final ContactMapper contactMapper = Mappers.getMapper(ContactMapper.class);

  @Test
    void toContactDto() {
        var contact = TestDataFactory.getContact();

        var resultingContactDto = contactMapper.toContactDto(contact);

        assertEquals(1, resultingContactDto.getId());
        assertEquals("Erik", resultingContactDto.getFirstName());
        assertEquals("Rz", resultingContactDto.getLastName());
        assertEquals("erikrz@github.com", resultingContactDto.getEmail());
        assertEquals("(123) 456 7890", resultingContactDto.getPhoneNumber());
        assertEquals(Instant.parse("2023-03-28T15:00:00.00Z"), contact.getCreatedDate());
        assertEquals(Instant.parse("2023-03-28T15:01:00.00Z"), contact.getLastModifiedDate());
    }
}
```

### Core AssertJ

```java
class ContactMapperWithCoreAssertJTest {
    
    private final ContactMapper contactMapper = Mappers.getMapper(ContactMapper.class);
    
    @Test
    void toContactDto() {
        var contact = TestDataFactory.getContact();

        var resultingContactDto = contactMapper.toContactDto(contact);

        assertThat(resultingContactDto.getId()).isEqualTo(1L);
        assertThat(resultingContactDto.getFirstName()).isEqualTo("Erik");
        assertThat(resultingContactDto.getLastName()).isEqualTo("Rz");
        assertThat(resultingContactDto.getEmail()).isEqualTo("erikrz@github.com");
        assertThat(resultingContactDto.getPhoneNumber()).isEqualTo("(123) 456 7890");
        assertThat(resultingContactDto.getCreatedDate()).isEqualTo("2023-03-28T15:00:00.00Z");
        assertThat(resultingContactDto.getLastModifiedDate()).isEqualTo("2023-03-28T15:01:00.00Z");
    }
    
}
```

### Generated AssertJ

```java
class ContactMapperWithGeneratedAssertJTest {
    
    private final ContactMapper contactMapper = Mappers.getMapper(ContactMapper.class);

    @Test
    void toContactDto() {
        var contact = TestDataFactory.getContact();

        var resultingContactDto = contactMapper.toContactDto(contact);

        assertThat(resultingContactDto)
                .hasId(1L)
                .hasFirstName("Erik")
                .hasLastName("Rz")
                .hasEmail("erikrz@github.com")
                .hasPhoneNumber("(123) 456 7890")
                .hasCreatedDate(Instant.parse("2023-03-28T15:00:00.00Z"))
                .hasLastModifiedDate(Instant.parse("2023-03-28T15:01:00.00Z"));
    }
    
}
```

## Local Development

### Prerequisites

* **Open JDK 17**

  You can install any version, i.e. [Amazon Coretto](https://docs.aws.amazon.com/corretto/latest/corretto-17-ug/downloads-list.html).

* **Maven**

  You can use the embedded Maven binaries that your IDE offers, or you can install your own one.
  
### Building all the components

We use Maven as our build tool. Here is the [Maven Build Lifecycle](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html) for reference.

Maven goals commonly used in this project:

| Goals                               | Description                                                                                                                                                                                |
| ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `clean`                             | Removes all files generated by the previous build. Recommended to run first, before any build goal.                                                                                        |
| `versions:display-property-updates` | Scans the project and produces a report of those properties which are used to control artifact versions and which properties have newer versions available. Recommended to run standalone. |
| `compile`                           | Build goal to compile source code.                                                                                                                                                         |
| `test`                              | `compile` plus compile and run tests.                                                                                                                                                      |
| `package`                           | `test` plus package compiled code into a jar.                                                                                                                                              |
| `install`                           | `package` plus install in local maven repo for other local projects to reuse.                                                                                                              |

Sample maven command goal runs:

* `mvn clean test`
* `mvn clean install`
* `mvn versions:display-property-updates`

Open [contacts-service-parent](/) and run `mvn clean install`. This should build the all the necessary artifacts to run and consume this microservice.
In this sample, we have a RESTFul microservice that accepts JSON payload.


### Starting the Application

#### Locally

* Run `java -jar contacts-service/target/ContactsService.jar`
* Local swagger URL is available at [localhost:8080/swagger-ui.html](http://localhost:8080/swagger-ui.html)
